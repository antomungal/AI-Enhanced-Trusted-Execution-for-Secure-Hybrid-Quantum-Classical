# AI-Enhanced Trusted Execution for Secure Hybrid Quantum–Classical Workflows

This repository contains the reference implementation for the experiments reported in the manuscript:

> **“AI-Enhanced Trusted Execution for Secure Hybrid Quantum–Classical Workflows Using TPM-Anchored Post-Quantum Cryptography”**  

The code implements a defence-in-depth architecture that combines:

- A TPM-equipped edge device (Raspberry Pi 5) as hardware root of trust.
- Post-quantum TLS (PQC-TLS) using ML-KEM and ML-DSA / SPHINCS\+\ via Open Quantum Safe.
- A remote quantum backend (Qiskit) accessed over PQC-TLS.
- An edge-resident Isolation Forest detector monitoring hybrid quantum–classical execution traces.

The repository includes all scripts, configurations and datasets required to reproduce the experimental results and figures used in the paper.

---

## 1. Repository Structure

```text
.
├── README.md
├── LICENSE
├── requirements.txt
├── edge/
│   ├── tpm_trng_benchmark.py          # TPM TRNG vs /dev/urandom benchmark
│   ├── figura_bench.py                # entropy throughput figure (log-scale)
│   ├── bench_qjob_with_plots.py       # PQC-TLS quantum job benchmark + plots
│   ├── dataset_building.py            # dataset generation for anomaly detection
│   ├── anomaly_IF.py                  # Isolation Forest training & evaluation
│   ├── config/
│   │   ├── oqs-openssl-client.cnf     # OpenSSL + OQS client config
│   │   └── client_pqc_certs/         # client certificates (PQC)
│   └── data/                          # CSVs generated by the experiments
├── backend/
│   ├── app_qbackend.py                # Flask REST API exposing /qjob
│   ├── attest_server.py               # (optional) TPM attestation endpoint /attest
│   ├── config/
│   │   ├── oqs-openssl-server.cnf     # OpenSSL + OQS server config
│   │   ├── generate_pqc_certs.sh      # helper script to create PQC certs
│   │   └── server_pqc_certs/          # server certificates (PQC)
│   └── qiskit_circuits.py             # parametric circuit templates
├── figures/
│   ├── entropy_throughput_log.pdf
│   ├── rtt_vs_circuit_pqc_tls_mlkem_mldsa.pdf
│   ├── backend_exec_vs_circuit_pqc_tls_mlkem_mldsa.pdf
│   ├── anomaly_score_histogram.pdf
│   ├── score_scatter_3d.pdf
│   └── rtt_boxplot_by_qubits.pdf
└── scripts/
    ├── run_trng_benchmark.sh
    ├── run_pqc_tls_benchmark.sh
    ├── run_dataset_building.sh
    └── run_anomaly_IF.sh

